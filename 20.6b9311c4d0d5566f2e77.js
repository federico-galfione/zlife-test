(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"1omm":function(t,e,n){"use strict";n.r(e),n.d(e,"MessaggiModule",(function(){return oe}));var c=n("Valr"),a=n("DUip"),s=n("ey9i"),i=n("6onV"),o=Object(i.o)(s.k),r=Object(i.q)(o,(function(t){return t.contattiPage.contatti})),u=Object(i.q)(o,(function(t){return t.contattiPage.currentPage})),l=Object(i.q)(o,(function(t){return t.chatPage.currentChat.messages})),f=Object(i.q)(o,(function(t){return t.chatPage.currentChat.remoteUser})),m=Object(i.q)(o,(function(t){return t.chatPage.currentChat.typing})),g=Object(i.n)("[Contatti Page] Contatti Success Receiving",Object(s.p)()),h=Object(i.n)("[Contatti Page] Contatti Request"),p=Object(i.n)("[Chat Page] Messaggi Success Receiving",Object(s.p)()),b=Object(i.n)("[Chat Page] Richiesta Messaggi",Object(s.p)()),d=Object(i.n)("[Chat Page] Nuovo messaggio ricevuto",Object(s.p)()),v=Object(i.n)("[Contatti Page] La pagina \xe8 stata cambiata, carica nuovi contatti",Object(s.p)()),k=Object(i.n)("[Chat Page] Send Message",Object(s.p)()),y=Object(i.n)("[Chat Page] Set remote user",Object(s.p)()),O=Object(i.n)("[Chat Page] Typed Message",Object(s.p)()),C=n("67Y/"),j=n("TYT/"),I=n("mrSG"),P=n("AytR"),w=n("6blF"),x=n("/PH2"),_=n("cUzu"),S=n("Kp+N"),T=function(){function t(t,e,n,c){var a=this;this.http=t,this.socket=e,this.store=n,this.router=c,this.baseUrl=P.a.server.url,this.myUser={id:100,firstName:"Mario",lastName:"Rossi",image:"assets/icon/placeholder_face.png",role:"Paziente",unreadMsg:!1},this.socket.fromEvent("user/NewMessage").pipe(Object(x.a)(this.store.select((function(t){return t.remoteSession.isInitiator})))).subscribe((function(t){var e=Object(I.g)(t,2);e[1]&&a.store.dispatch(d({message:e[0],dispatchToRemote:!0,clearTyping:!1}))}))}return t.prototype.getContattiList=function(){return this.http.get(this.baseUrl+"/contacts")},t.prototype.getMessaggiList=function(t){return this.http.get(this.baseUrl+"/messages/"+t)},t.prototype.navigateToChat=function(t){this.store.dispatch(y({user:t,dispatchToRemote:!0})),this.router.navigate(["messaggi","chat",t.id])},t.prototype.receiveMessages=function(){var t=this;return this.store.select(l).pipe(Object(x.a)(this.store.select(f)),Object(C.a)((function(e){var n=Object(I.g)(e,2),c=n[1];return n[0].map((function(e){return{text:e.message,author:0===e.side?c:t.myUser,timestamp:new Date(e.creationTime)}}))})))},t.prototype.sendMessage=function(t,e){var n=this;return new w.a((function(c){n.socket.emit("user/SendMessage",{userId:t,message:e},(function(t){})),c.next(e)}))},t.\u0275fac=function(e){return new(e||t)(j.fc(_.b),j.fc(S.a),j.fc(i.h),j.fc(a.j))},t.\u0275prov=j.Qb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),M=n("sPEm"),z=n("vqQA"),Z=n("/733"),L=n("byPC"),U=n("sSbh"),A=function(){function t(){this.onClick=new j.o}return t.prototype.onClickHandler=function(){this.onClick.emit()},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=j.Ob({type:t,selectors:[["zlife-user"]],inputs:{user:"user"},outputs:{onClick:"onClick"},decls:13,vars:7,consts:[[1,"zlife-user__container"],[1,"zlife-user__card",3,"ngClass"],[1,"zlife-user__img-container"],[1,"zlife-user__img",3,"src"],[1,"zlife-user__ion-header"],[1,"zlife-user__div-right"],["type","default","icon","msg_icon","iconPosition","left",3,"text","elementId","onClick"]],template:function(t,e){1&t&&(j.ac(0,"div",0),j.ac(1,"ion-card",1),j.ac(2,"div",2),j.Vb(3,"img",3),j.Zb(),j.ac(4,"ion-card-header",4),j.ac(5,"ion-card-title"),j.Nc(6," Prefix "),j.ac(7,"b"),j.Nc(8),j.Zb(),j.Zb(),j.ac(9,"ion-card-subtitle"),j.Nc(10),j.Zb(),j.Zb(),j.ac(11,"div",5),j.ac(12,"zlife-ngrx-button",6),j.jc("onClick",(function(){return e.onClickHandler()})),j.Zb(),j.Zb(),j.Zb(),j.Zb()),2&t&&(j.Ib(1),j.sc("ngClass",e.user.unreadMsg?"zlife-user__container-border":""),j.Ib(2),j.sc("src",e.user.image,j.Fc),j.Ib(5),j.Qc("",e.user.firstName," ",e.user.lastName,""),j.Ib(2),j.Oc(e.user.role),j.Ib(2),j.sc("text",e.user.unreadMsg?"Nuovo messaggio":"Scrivi")("elementId","btn"+e.user.id))},directives:[M.c,c.j,M.d,M.f,M.e,U.a],styles:[".zlife-user__container[_ngcontent-%COMP%]{display:flex;height:100%}.zlife-user__container[_ngcontent-%COMP%]   .zlife-user__card[_ngcontent-%COMP%]{padding:20px;display:flex;flex:1}.zlife-user__container[_ngcontent-%COMP%]   .zlife-user__card[_ngcontent-%COMP%]   .zlife-user__img-container[_ngcontent-%COMP%]{height:100%}.zlife-user__container[_ngcontent-%COMP%]   .zlife-user__card[_ngcontent-%COMP%]   .zlife-user__img-container[_ngcontent-%COMP%]   .zlife-user__img[_ngcontent-%COMP%]{float:left;width:auto;height:100%}.zlife-user__container[_ngcontent-%COMP%]   .zlife-user__card[_ngcontent-%COMP%]   .zlife-user__ion-header[_ngcontent-%COMP%]{display:inline-block;flex:1}.zlife-user__container-border[_ngcontent-%COMP%]{border:4px solid #00f}"]}),t}();function F(t,e){if(1&t){var n=j.bc();j.Yb(0),j.ac(1,"zlife-user",6),j.jc("onClick",(function(){j.Dc(n);var t=e.$implicit;return j.mc().navigateToChat(t)})),j.Zb(),j.Xb()}if(2&t){var c=e.$implicit;j.Ib(1),j.sc("user",c)}}var $=function(){function t(t,e,n){this.store=t,this.router=e,this.messaggiService=n,this.messaggiFeatureKey=s.k,this.store.dispatch(h()),this.contatti$=this.store.select(r).pipe(Object(C.a)((function(t){var e=[];return t.forEach((function(t){t.unreadMsg?e.unshift(t):e.push(t)})),e}))),this.currentPage$=this.store.select(u)}return t.prototype.pageChanged=function(t){this.store.dispatch(v({currentPage:t,dispatchToRemote:!0}))},t.prototype.navigateToChat=function(t){this.messaggiService.navigateToChat(t)},t.\u0275fac=function(e){return new(e||t)(j.Ub(i.h),j.Ub(a.j),j.Ub(T))},t.\u0275cmp=j.Ob({type:t,selectors:[["app-contatti-page"]],features:[j.Hb([{provide:s.f,useFactory:s.f.create([s.k,"contattiPage"])}])],decls:13,vars:4,consts:[["padding",""],[1,"zlife-contatti-page__container"],[1,"zlife-contatti-page__title"],[1,"zlife-contatti-page__content"],["scrollName","contactsList",3,"elementsInPage","elements","pageChange"],[4,"zlifeListItem"],[3,"user","onClick"]],template:function(t,e){1&t&&(j.ac(0,"ion-header"),j.Vb(1,"zlife-status-bar"),j.Zb(),j.ac(2,"ion-content",0),j.ac(3,"div",1),j.ac(4,"div",2),j.ac(5,"h1"),j.ac(6,"i"),j.Nc(7,"msg_img"),j.Zb(),j.Nc(8," Invia un messaggio"),j.Zb(),j.Zb(),j.ac(9,"div",3),j.ac(10,"zlife-list-scroller-tracker",4),j.jc("pageChange",(function(t){return e.pageChanged(t)})),j.nc(11,"async"),j.Lc(12,F,2,1,"ng-container",5),j.Zb(),j.Zb(),j.Zb(),j.Zb()),2&t&&(j.Ib(10),j.sc("elementsInPage",3)("elements",j.oc(11,2,e.contatti$)))},directives:[M.k,z.a,M.g,Z.a,L.a,A],pipes:[c.b],styles:[".zlife-contatti-page__container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.zlife-contatti-page__container[_ngcontent-%COMP%]   .zlife-contatti-page__content[_ngcontent-%COMP%]{flex:1;min-height:0}"]}),t}(),N=n("P6uZ"),E=n("CYVr"),D=n("iLY4"),R=n("Axka"),V=n("bne5"),B=n("Gi3i"),H=n("IZi1"),K=["messageInput"],q=["messageList"],Y=["messagePlaceholder",$localize(I.f([":kendo.chat.messagePlaceholder|The placholder text of the message text input\u241fa4e7da5ddd2f2db3f0b322b0a162a524dfe6cb81\u241f7460803912395701353:Type a message..."],[":kendo.chat.messagePlaceholder|The placholder text of the message text input\u241fa4e7da5ddd2f2db3f0b322b0a162a524dfe6cb81\u241f7460803912395701353:Type a message..."])),"send",$localize(I.f([":kendo.chat.send|The text for the Send button\u241f94410f5d089bd36108a60e3b1b04d47f8ea1b94a\u241f4984081606393486044:Send..."],[":kendo.chat.send|The text for the Send button\u241f94410f5d089bd36108a60e3b1b04d47f8ea1b94a\u241f4984081606393486044:Send..."]))];function J(t,e){1&t&&j.Wb(0)}function Q(t,e){if(1&t&&(j.Yb(0),j.Lc(1,J,1,0,"ng-container",2),j.Xb()),2&t){var n=j.mc();j.Ib(1),j.sc("ngTemplateOutlet",n.template.templateRef)("ngTemplateOutletContext",n.context)}}function W(t,e){if(1&t&&(j.ac(0,"h5",7),j.Nc(1),j.Zb()),2&t){var n=j.mc(2);j.Ib(1),j.Pc(" ",n.attachment.title," ")}}function X(t,e){if(1&t&&(j.ac(0,"h6",8),j.Nc(1),j.Zb()),2&t){var n=j.mc(2);j.Ib(1),j.Pc(" ",n.attachment.subtitle," ")}}function G(t,e){if(1&t&&j.Vb(0,"img"),2&t){var n=j.mc(2);j.Jb("src",n.attachment.content,j.Fc)}}function tt(t,e){if(1&t&&(j.Yb(0),j.Nc(1),j.Xb()),2&t){var n=j.mc(2);j.Ib(1),j.Pc(" ",n.attachment.content," ")}}function et(t,e){if(1&t&&(j.ac(0,"div",3),j.ac(1,"div",4),j.Lc(2,W,2,1,"h5",5),j.Lc(3,X,2,1,"h6",6),j.Lc(4,G,1,1,"img",0),j.Lc(5,tt,2,1,"ng-container",0),j.Zb(),j.Zb()),2&t){var n=j.mc();j.Ib(2),j.sc("ngIf",n.attachment.title),j.Ib(1),j.sc("ngIf",n.attachment.subtitle),j.Ib(1),j.sc("ngIf",n.image),j.Ib(1),j.sc("ngIf",n.unknown)}}var nt=["deck"],ct=["item"];function at(t,e){if(1&t){var n=j.bc();j.ac(0,"button",3),j.jc("click",(function(){return j.Dc(n),j.mc().scrollTo(-1)})),j.Vb(1,"span",4),j.Zb()}}function st(t,e){if(1&t){var n=j.bc();j.ac(0,"kendo-chat-attachment",5,6),j.jc("click",(function(){j.Dc(n);var t=e.index;return j.mc().itemClick(t)}))("keydown",(function(t){j.Dc(n);var c=e.$implicit;return j.mc().itemKeydown(t,c)})),j.Zb()}if(2&t){var c=e.$implicit,a=e.index,s=e.first,i=e.last,o=j.mc();j.Mb("k-state-selected",o.isSelected(a))("k-state-focused",o.isSelected(a))("k-card-wrap",!0)("k-first",s)("k-last",i),j.sc("attachment",c)("template",o.template),j.Jb("tabindex",o.tabbable&&o.isSelected(a)?"0":"-1")}}function it(t,e){if(1&t){var n=j.bc();j.ac(0,"button",3),j.jc("click",(function(){return j.Dc(n),j.mc().scrollTo(1)})),j.Vb(1,"span",7),j.Zb()}}function ot(t,e){if(1&t&&(j.ac(0,"time",4),j.Nc(1),j.Zb()),2&t){var n=j.mc();j.Jb("aria-hidden",!n.selected),j.Ib(1),j.Pc(" ",n.formatTimeStamp(n.message.timestamp)," ")}}function rt(t,e){1&t&&j.Wb(0)}var ut=function(t){return{$implicit:t}};function lt(t,e){if(1&t&&(j.ac(0,"div",6),j.Lc(1,rt,1,0,"ng-container",7),j.Zb()),2&t){var n=j.mc(2);j.Ib(1),j.sc("ngTemplateOutlet",n.template.templateRef)("ngTemplateOutletContext",j.vc(2,ut,n.message))}}function ft(t,e){if(1&t&&(j.ac(0,"div",6),j.Nc(1),j.Zb()),2&t){var n=j.mc(2);j.Ib(1),j.Pc(" ",n.message.text," ")}}function mt(t,e){if(1&t&&(j.Yb(0),j.Lc(1,lt,2,4,"div",5),j.Lc(2,ft,2,1,"div",5),j.Xb()),2&t){var n=j.mc();j.Ib(1),j.sc("ngIf",n.template),j.Ib(1),j.sc("ngIf",!n.template&&n.message.text)}}function gt(t,e){if(1&t&&(j.ac(0,"span",8),j.Nc(1),j.Zb()),2&t){var n=j.mc();j.Ib(1),j.Pc(" ",n.message.status," ")}}function ht(t,e){1&t&&(j.ac(0,"div",6),j.ac(1,"div",9),j.Vb(2,"span"),j.Vb(3,"span"),j.Vb(4,"span"),j.Zb(),j.Zb())}function pt(t,e){if(1&t&&(j.ac(0,"div",7),j.Nc(1),j.Zb()),2&t){var n=j.mc().$implicit,c=j.mc();j.Ib(1),j.Pc(" ",c.formatTimeStamp(n.timestamp)," ")}}function bt(t,e){if(1&t&&j.Vb(0,"img",12),2&t){var n=j.mc(2).$implicit;j.Jb("src",n.author.avatarUrl,j.Fc)}}function dt(t,e){if(1&t&&(j.ac(0,"p",13),j.Nc(1),j.Zb()),2&t){var n=j.mc(2).$implicit;j.Ib(1),j.Oc(n.author.name)}}function vt(t,e){if(1&t&&j.Vb(0,"img",18),2&t){var n=j.mc().$implicit;j.sc("src",null==n.user?null:n.user.avatarUrl,j.Fc)}}function kt(t,e){if(1&t&&j.Vb(0,"kendo-chat-attachment",19),2&t){var n=j.mc().$implicit,c=j.mc(3);j.sc("attachment",n.attachments[0])("template",c.attachmentTemplate)}}function yt(t,e){if(1&t){var n=j.bc();j.Yb(0),j.Lc(1,vt,1,1,"img",14),j.ac(2,"kendo-chat-message",15,16),j.jc("click",(function(){j.Dc(n);var t=j.Cc(3);return j.mc(3).select(t)}))("focus",(function(){j.Dc(n);var t=j.Cc(3);return j.mc(3).select(t)})),j.Zb(),j.Lc(4,kt,1,2,"kendo-chat-attachment",17),j.Xb()}if(2&t){var c=e.$implicit,a=e.first,s=e.last,i=j.mc(2),o=i.$implicit,r=i.last,u=j.mc();j.Ib(1),j.sc("ngIf",null==c.user?null:c.user.avatarUrl),j.Ib(1),j.Mb("k-only",1===o.messages.length)("k-first",o.messages.length>1&&a)("k-last",o.messages.length>1&&s),j.sc("message",c)("tabbable",r&&s)("template",u.messageTemplate),j.Ib(2),j.sc("ngIf",c.attachments&&1===c.attachments.length)}}function Ot(t,e){if(1&t&&(j.ac(0,"div",8),j.Lc(1,bt,1,1,"img",9),j.Lc(2,dt,2,1,"p",10),j.Lc(3,yt,5,11,"ng-container",11),j.Zb()),2&t){var n=j.mc().$implicit,c=j.mc();j.Mb("k-alt",c.isOwnMessage(n.messages[0]))("k-no-avatar",!n.author.avatarUrl),j.Ib(1),j.sc("ngIf",n.author.avatarUrl),j.Ib(1),j.sc("ngIf",n.author.name),j.Ib(1),j.sc("ngForOf",n.messages)}}function Ct(t,e){if(1&t){var n=j.bc();j.ac(0,"kendo-chat-message-attachments",20,21),j.jc("click",(function(){j.Dc(n);var t=j.Cc(1);return j.mc(2).select(t)}))("focus",(function(){j.Dc(n);var t=j.Cc(1);return j.mc(2).select(t)})),j.Zb()}if(2&t){var c=j.mc(),a=c.$implicit,s=c.last,i=j.mc();j.sc("attachments",a.attachments)("layout",a.attachmentLayout)("tabbable",s)("template",i.attachmentTemplate)}}function jt(t,e){if(1&t){var n=j.bc();j.ac(0,"kendo-chat-suggested-actions",22,23),j.jc("dispatch",(function(t){j.Dc(n);var e=j.mc().$implicit,c=j.mc();return c.dispatchAction(t,c.last(e.messages))}))("click",(function(){j.Dc(n);var t=j.Cc(1);return j.mc(2).select(t)}))("focus",(function(){j.Dc(n);var t=j.Cc(1);return j.mc(2).select(t)})),j.Zb()}if(2&t){var c=j.mc(),a=c.last;j.sc("actions",c.$implicit.actions)("tabbable",a)}}function It(t,e){if(1&t&&(j.Yb(0),j.Yb(1,2),j.Lc(2,pt,2,1,"div",3),j.Lc(3,Ot,4,7,"div",4),j.Lc(4,Ct,2,4,"kendo-chat-message-attachments",5),j.Lc(5,jt,2,2,"kendo-chat-suggested-actions",6),j.Xb(),j.Xb()),2&t){var n=e.$implicit;j.Ib(1),j.sc("ngSwitch",n.type),j.Ib(1),j.sc("ngSwitchCase","date-marker"),j.Ib(1),j.sc("ngSwitchCase","message-group"),j.Ib(1),j.sc("ngSwitchCase","attachment-group"),j.Ib(1),j.sc("ngSwitchCase","action-group")}}function Pt(t,e){if(1&t){var n=j.bc();j.ac(0,"span",1,2),j.jc("click",(function(){j.Dc(n);var t=e.$implicit;return j.mc().actionClick(t)}))("keydown",(function(t){j.Dc(n);var c=e.$implicit;return j.mc().actionKeydown(t,c)})),j.Nc(2),j.Zb()}if(2&t){var c=e.$implicit,a=e.index,s=e.first,i=e.last,o=j.mc();j.Mb("k-state-selected",o.isSelected(a))("k-state-focused",o.isSelected(a))("k-first",s)("k-last",i),j.Jb("tabindex",o.tabbable&&o.selectedIndex===a?"0":"-1"),j.Ib(2),j.Pc(" ",c.title||c.value," ")}}var wt=function(){function t(t){this.templateRef=t}return t.\u0275fac=function(e){return new(e||t)(j.Ub(j.P,8))},t.\u0275dir=j.Pb({type:t,selectors:[["","kendoChatAttachmentTemplate",""]]}),t}(),xt=function(){return function(t){this.message=t}}(),_t=function(){},St={reply:function(t,e){e.sendMessage.emit(new xt({author:e.user,text:t.value,timestamp:new Date}))},call:function(t){window.open("tel:"+t.value)},openUrl:function(t){window.open(t.value)}},Tt=function(){function t(t){this.templateRef=t}return t.\u0275fac=function(e){return new(e||t)(j.Ub(j.P,8))},t.\u0275dir=j.Pb({type:t,selectors:[["","kendoChatMessageTemplate",""]]}),t}(),Mt=function(){function t(t,e){var n=this;this.localization=t,this.zone=e,this.sendMessage=new j.o,this.executeAction=new j.o,this.autoScroll=!0,this.direction=t.rtl?"rtl":"ltr",this.localizationChangeSubscription=t.changes.subscribe((function(t){n.direction=t.rtl?"rtl":"ltr"}))}return Object.defineProperty(t.prototype,"className",{get:function(){return"k-widget k-chat"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dirAttr",{get:function(){return this.direction},enumerable:!0,configurable:!0}),t.prototype.ngOnChanges=function(){var t=this;this.zone.runOutsideAngular((function(){return setTimeout((function(){t.messageList.nativeElement.style.flex="1 1 auto"}))}))},t.prototype.ngAfterViewInit=function(){if(Object(j.bb)()&&!this.user)throw new Error("User must be set and have a valid id.")},t.prototype.ngOnDestroy=function(){this.localizationChangeSubscription&&this.localizationChangeSubscription.unsubscribe()},t.prototype.sendClick=function(){var t=this.messageInput.nativeElement,e=t.value;if(e){var n={author:this.user,text:e,timestamp:new Date};this.sendMessage.emit(new xt(n)),t.value=null,t.focus(),this.autoScroll=!0}},t.prototype.inputKeydown=function(t){13===t.keyCode&&this.sendClick()},t.prototype.dispatchAction=function(t){this.executeAction.emit(t),t.isDefaultPrevented()||((St[t.action.type]||_t)(t.action,this),this.messageInput.nativeElement.focus())},t.prototype.textFor=function(t){return this.localization.get(t)},t.\u0275fac=function(e){return new(e||t)(j.Ub(E.c),j.Ub(j.C))},t.\u0275cmp=j.Ob({type:t,selectors:[["kendo-chat"]],contentQueries:function(t,e,n){var c;1&t&&(j.Nb(n,wt,!0),j.Nb(n,Tt,!0)),2&t&&(j.Bc(c=j.kc())&&(e.attachmentTemplate=c.first),j.Bc(c=j.kc())&&(e.messageTemplate=c.first))},viewQuery:function(t,e){var n;1&t&&(j.Rc(K,!0),j.Rc(q,!0)),2&t&&(j.Bc(n=j.kc())&&(e.messageInput=n.first),j.Bc(n=j.kc())&&(e.messageList=n.first))},hostVars:3,hostBindings:function(t,e){2&t&&(j.Jb("dir",e.dirAttr),j.Kb(e.className))},inputs:{messages:"messages",user:"user"},outputs:{sendMessage:"sendMessage",executeAction:"executeAction"},features:[j.Hb([E.c,{provide:E.b,useValue:"kendo.chat"}]),j.Gb],decls:12,vars:7,consts:[["kendoChatLocalizedMessages","",6,"messagePlaceholder","send"],["aria-live","polite","role","log","kendoChatScrollAnchor","",1,"k-message-list","k-avatars",3,"autoScroll","autoScrollChange"],["messageList","","anchor","scrollAnchor"],[3,"messages","messageTemplate","attachmentTemplate","user","executeAction","resize","navigate"],[1,"k-message-box"],["kendoChatFocusedState","","type","text",1,"k-input",3,"placeholder","keydown"],["messageInput",""],["kendoButton","","look","flat","tabindex","-1",1,"k-button-send",3,"click"],["version","1.1","xmlns","http://www.w3.org/2000/svg","x","0px","y","0px","viewBox","0 0 16 16"],["d","M0,14.3c-0.1,0.6,0.3,0.8,0.8,0.6l14.8-6.5c0.5-0.2,0.5-0.6,0-0.8L0.8,1.1C0.3,0.9-0.1,1.1,0,1.7l0.7,4.2C0.8,6.5,1.4,7,1.9,7.1l8.8,0.8c0.6,0.1,0.6,0.1,0,0.2L1.9,8.9C1.4,9,0.8,9.5,0.7,10.1L0,14.3z"]],template:function(t,e){if(1&t){var n=j.bc();j.Yb(0,0),j.ec(1,Y),j.Xb(),j.ac(2,"div",1,2),j.jc("autoScrollChange",(function(t){return e.autoScroll=t})),j.ac(5,"kendo-chat-message-list",3),j.jc("executeAction",(function(t){return e.dispatchAction(t)}))("resize",(function(){return j.Dc(n),j.Cc(4).scrollToBottom()}))("navigate",(function(){return e.autoScroll=!1})),j.Zb(),j.Zb(),j.ac(6,"div",4),j.ac(7,"input",5,6),j.jc("keydown",(function(t){return e.inputKeydown(t)})),j.Zb(),j.ac(9,"button",7),j.jc("click",(function(){return e.sendClick()})),j.lc(),j.ac(10,"svg",8),j.Vb(11,"path",9),j.Zb(),j.Zb(),j.Zb()}2&t&&(j.Ib(2),j.sc("autoScroll",e.autoScroll),j.Ib(3),j.sc("messages",e.messages)("messageTemplate",e.messageTemplate)("attachmentTemplate",e.attachmentTemplate)("user",e.user),j.Ib(2),j.sc("placeholder",e.textFor("messagePlaceholder")),j.Ib(2),j.Jb("title",e.textFor("send")))},directives:function(){return[At,Bt,Vt,Ut,D.a]},encapsulation:2}),t}(),zt=function(){function t(){}return Object.defineProperty(t.prototype,"attachment",{get:function(){return this._attachment},set:function(t){this._attachment=t,this.context={$implicit:this.attachment}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return 0===this.contentType.indexOf("image/")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unknown",{get:function(){return!this.image},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return this.attachment.contentType||""},enumerable:!0,configurable:!0}),t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=j.Ob({type:t,selectors:[["kendo-chat-attachment"]],inputs:{attachment:"attachment",template:"template"},decls:2,vars:2,consts:[[4,"ngIf"],["class","k-card",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"k-card"],[1,"k-card-body"],["class","k-card-title",4,"ngIf"],["class","k-card-subtitle",4,"ngIf"],[1,"k-card-title"],[1,"k-card-subtitle"]],template:function(t,e){1&t&&(j.Lc(0,Q,2,2,"ng-container",0),j.Lc(1,et,6,4,"div",1)),2&t&&(j.sc("ngIf",e.template),j.Ib(1),j.sc("ngIf",!e.template))},directives:[c.l,c.p],encapsulation:2}),t}(),Zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(I.d)(e,t),e.\u0275fac=function(t){return n(t||e)},e.\u0275dir=j.Pb({type:e,inputs:{messagePlaceholder:"messagePlaceholder",send:"send"},features:[j.Fb]});var n=j.cc(e);return e}(E.a),Lt=function(t){function e(e){var n=t.call(this)||this;return n.service=e,n}return Object(I.d)(e,t),Object.defineProperty(e.prototype,"override",{get:function(){return!0},enumerable:!0,configurable:!0}),e.\u0275fac=function(t){return new(t||e)(j.Ub(E.c))},e.\u0275cmp=j.Ob({type:e,selectors:[["kendo-chat-messages"]],features:[j.Hb([{provide:Zt,useExisting:Object(j.Z)((function(){return e}))}]),j.Fb],decls:0,vars:0,template:function(t,e){},encapsulation:2}),e}(Zt),Ut=function(){function t(){this.focused=!1}return t.prototype.onFocus=function(){this.focused=!0},t.prototype.onBlur=function(){this.focused=!1},t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=j.Pb({type:t,selectors:[["","kendoChatFocusedState",""]],hostVars:2,hostBindings:function(t,e){1&t&&j.jc("focusin",(function(){return e.onFocus()}))("focusout",(function(){return e.onBlur()})),2&t&&j.Mb("k-state-focused",e.focused)}}),t}(),At=function(t){function e(e){var n=t.call(this)||this;return n.service=e,n}return Object(I.d)(e,t),e.\u0275fac=function(t){return new(t||e)(j.Ub(E.c))},e.\u0275dir=j.Pb({type:e,selectors:[["","kendoChatLocalizedMessages",""]],features:[j.Hb([{provide:Zt,useExisting:Object(j.Z)((function(){return e}))}]),j.Fb]}),e}(Zt),Ft=function(){return function(){}}(),$t=function(t){function e(e){var n,c,a=t.call(this)||this;return a.zone=e,a.scrollPosition=0,a.selectedIndex=0,a.carouselKeyHandlers=((n={})[37]=function(t){return a.navigateTo(t,-1)},n[39]=function(t){return a.navigateTo(t,1)},n),a.listKeyHandlers=((c={})[38]=function(t){return a.navigateTo(t,-1)},c[40]=function(t){return a.navigateTo(t,1)},c),a}return Object(I.d)(e,t),Object.defineProperty(e.prototype,"carousel",{get:function(){return"list"!==this.layout},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var t=this;this.zone.runOutsideAngular((function(){t.scrollSubscription=Object(V.a)(t.deck.nativeElement,"scroll").pipe(Object(B.a)(100)).subscribe((function(){return t.onScroll()}))}))},e.prototype.ngOnDestroy=function(){this.scrollSubscription.unsubscribe()},e.prototype.isSelected=function(t){return this.selectedIndex===t},e.prototype.itemKeydown=function(t,e){var n=("list"===this.layout?this.listKeyHandlers:this.carouselKeyHandlers)[t.keyCode];n&&n(t,e)},e.prototype.itemClick=function(t){this.select(t)},e.prototype.focus=function(){this.select(this.selectedIndex)},e.prototype.scrollTo=function(t){var e=this.deck.nativeElement;e.scrollLeft=Math.max(0,Math.min(e.scrollWidth-e.offsetWidth,e.scrollLeft+e.scrollWidth/this.items.length*t))},e.prototype.select=function(t){this.selectedIndex=t;var e=this.items.toArray()[t];e&&e.nativeElement.focus()},e.prototype.navigateTo=function(t,e){var n=this.selectedIndex,c=Math.max(0,Math.min(n+e,this.items.length-1));c!==n&&(this.select(c),t.preventDefault())},e.prototype.onScroll=function(){var t=this,e=this.deck.nativeElement;if(0!==e.scrollWidth){var n=e.scrollLeft/(e.scrollWidth-e.offsetWidth);n!==this.scrollPosition&&this.zone.run((function(){t.scrollPosition=n}))}},e.\u0275fac=function(t){return new(t||e)(j.Ub(j.C))},e.\u0275cmp=j.Ob({type:e,selectors:[["kendo-chat-message-attachments"]],viewQuery:function(t,e){var n;1&t&&(j.Rc(nt,!0,j.m),j.Rc(ct,!0,j.m)),2&t&&(j.Bc(n=j.kc())&&(e.deck=n.first),j.Bc(n=j.kc())&&(e.items=n))},hostVars:2,hostBindings:function(t,e){2&t&&j.Mb("k-card-deck-scrollwrap",e.carousel)},inputs:{attachments:"attachments",layout:"layout",tabbable:"tabbable",template:"template"},features:[j.Hb([{provide:Ft,useExisting:Object(j.Z)((function(){return e}))}]),j.Fb],decls:5,vars:5,consts:[["class","k-button k-button-icon","tabindex","-1",3,"click",4,"ngIf"],["deck",""],[3,"attachment","template","k-state-selected","k-state-focused","k-card-wrap","k-first","k-last","click","keydown",4,"ngFor","ngForOf"],["tabindex","-1",1,"k-button","k-button-icon",3,"click"],[1,"k-icon","k-i-arrow-chevron-left"],[3,"attachment","template","click","keydown"],["item",""],[1,"k-icon","k-i-arrow-chevron-right"]],template:function(t,e){1&t&&(j.Lc(0,at,2,0,"button",0),j.ac(1,"div",null,1),j.Lc(3,st,2,13,"kendo-chat-attachment",2),j.Zb(),j.Lc(4,it,2,0,"button",0)),2&t&&(j.sc("ngIf",e.carousel&&e.scrollPosition>0),j.Ib(1),j.Mb("k-card-deck",e.carousel),j.Ib(2),j.sc("ngForOf",e.attachments),j.Ib(1),j.sc("ngIf",e.carousel&&e.scrollPosition<1))},directives:[c.l,c.k,zt],encapsulation:2}),e}(Ft),Nt=function(t){function e(e,n){var c=t.call(this)||this;return c.element=e,c.intl=n,c.cssClass=!0,c}return Object(I.d)(e,t),Object.defineProperty(e.prototype,"tabIndex",{get:function(){return this.tabbable?"0":"-1"},enumerable:!0,configurable:!0}),e.prototype.formatTimeStamp=function(t){return this.intl.formatDate(t,{datetime:"short"})},e.prototype.focus=function(){this.element.nativeElement.focus()},e.\u0275fac=function(t){return new(t||e)(j.Ub(j.m),j.Ub(H.IntlService))},e.\u0275cmp=j.Ob({type:e,selectors:[["kendo-chat-message"]],hostVars:7,hostBindings:function(t,e){2&t&&(j.Jb("tabIndex",e.tabIndex),j.Mb("k-message",e.cssClass)("k-state-selected",e.selected)("k-state-focused",e.selected))},inputs:{message:"message",tabbable:"tabbable",template:"template"},features:[j.Hb([{provide:Ft,useExisting:Object(j.Z)((function(){return e}))}]),j.Fb],decls:5,vars:4,consts:[["class","k-message-time",4,"ngIf"],[4,"ngIf","ngIfElse"],["class","k-message-status",4,"ngIf"],["typing",""],[1,"k-message-time"],["class","k-bubble",4,"ngIf"],[1,"k-bubble"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"k-message-status"],[1,"k-typing-indicator"]],template:function(t,e){if(1&t&&(j.Lc(0,ot,2,2,"time",0),j.Lc(1,mt,3,2,"ng-container",1),j.Lc(2,gt,2,1,"span",2),j.Lc(3,ht,5,0,"ng-template",null,3,j.Mc)),2&t){var n=j.Cc(4);j.sc("ngIf",e.message.timestamp),j.Ib(1),j.sc("ngIf",!e.message.typing)("ngIfElse",n),j.Ib(1),j.sc("ngIf",e.message.status)}},directives:[c.l,c.p],encapsulation:2}),e}(Ft),Et=function(t){function e(e,n){var c=t.call(this)||this;return c.action=e,c.message=n,c}return Object(I.d)(e,t),e}(function(){function t(){this.prevented=!1}return t.prototype.preventDefault=function(){this.prevented=!0},t.prototype.isDefaultPrevented=function(){return this.prevented},t}()),Dt=function(t,e){return t&&e.author&&t.id===e.author.id},Rt=function(t){return t[t.length-1]},Vt=function(){function t(t,e){var n,c=this;this.element=t,this.intl=e,this.executeAction=new j.o,this.navigate=new j.o,this.resize=new j.o,this.cssClass=!0,this.view=[],this.keyActions=((n={})[38]=function(t){return c.navigateTo(t,-1)},n[40]=function(t){return c.navigateTo(t,1)},n)}return Object.defineProperty(t.prototype,"messages",{get:function(){return this._messages},set:function(t){var e,n,c=t||[];this.view=(e=c).reduce((n=e.length,function(t,e,c){var a=c===n-1;return function(t,e){var n,c,a=e.timestamp,s=Rt(t);if(a&&(!s||(c=s.timestamp,(n=a)&&c&&(c.getDate()!==n.getDate()||c.getMonth()!==n.getMonth()||c.getFullYear()!==n.getFullYear())))){var i={type:"date-marker",timestamp:a,trackBy:a.getTime()};t.push(i)}}(t,e),function(t,e,n){var c,a=Rt(t);if(Object(j.bb)()&&!e.author)throw new Error("Author must be set for message: "+JSON.stringify(e));e.typing&&!n||(a&&"message-group"===a.type&&(c=a.messages),c&&Dt(e.author,Rt(c))?c.push(e):t.push({type:"message-group",messages:[e],author:e.author,timestamp:e.timestamp,trackBy:e}))}(t,e,a),e.attachments&&e.attachments.length>1&&t.push({type:"attachment-group",attachments:e.attachments,attachmentLayout:e.attachmentLayout,timestamp:e.timestamp,trackBy:e}),e.suggestedActions&&a&&t.push({type:"action-group",actions:e.suggestedActions,timestamp:e.timestamp,trackBy:e}),t}),[]),this._messages=c},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewInit=function(){this.selectedItem=this.items.last},t.prototype.onResize=function(){this.resize.emit()},t.prototype.formatTimeStamp=function(t){return this.intl.formatDate(t,{date:"full"})},t.prototype.onKeydown=function(t){var e=this.keyActions[t.keyCode];e&&e(t)},t.prototype.onBlur=function(t){var e=this;!function(t,e){for(;t&&!e(t);)t=t.parentNode;return t}(t.relatedTarget||document.activeElement,(function(t){return t===e.element.nativeElement}))&&this.select(null)},t.prototype.isOwnMessage=function(t){return Dt(this.user,t)},t.prototype.dispatchAction=function(t,e){var n=new Et(t,e);this.executeAction.emit(n)},t.prototype.trackGroup=function(t,e){return e.trackBy},t.prototype.select=function(t){var e=this.selectedItem;e&&(e.selected=!1),t&&(t.selected=!0,this.selectedItem=t)},t.prototype.last=function(t){if(t&&0!==t.length)return t[t.length-1]},t.prototype.navigateTo=function(t,e){var n=this.items.toArray(),c=this.selectedItem,a=n.indexOf(c),s=n[Math.max(0,Math.min(a+e,this.items.length-1))];s!==c&&(this.select(s),s.focus(),this.navigate.emit(),t.preventDefault())},t.\u0275fac=function(e){return new(e||t)(j.Ub(j.m),j.Ub(H.IntlService))},t.\u0275cmp=j.Ob({type:t,selectors:[["kendo-chat-message-list"]],viewQuery:function(t,e){var n;1&t&&j.Rc(Ft,!0),2&t&&j.Bc(n=j.kc())&&(e.items=n)},hostVars:2,hostBindings:function(t,e){1&t&&j.jc("keydown",(function(t){return e.onKeydown(t)}))("focusout",(function(t){return e.onBlur(t)})),2&t&&j.Mb("k-message-list-content",e.cssClass)},inputs:{messages:"messages",attachmentTemplate:"attachmentTemplate",messageTemplate:"messageTemplate",user:"user"},outputs:{executeAction:"executeAction",navigate:"navigate",resize:"resize"},decls:2,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[3,"resize"],[3,"ngSwitch"],["class","k-timestamp",4,"ngSwitchCase"],["class","k-message-group",3,"k-alt","k-no-avatar",4,"ngSwitchCase"],[3,"attachments","layout","tabbable","template","click","focus",4,"ngSwitchCase"],[3,"actions","tabbable","dispatch","click","focus",4,"ngSwitchCase"],[1,"k-timestamp"],[1,"k-message-group"],["class","k-avatar",4,"ngIf"],["class","k-author",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"k-avatar"],[1,"k-author"],["class","k-avatar",3,"src",4,"ngIf"],[3,"message","tabbable","template","click","focus"],["message",""],[3,"attachment","template",4,"ngIf"],[1,"k-avatar",3,"src"],[3,"attachment","template"],[3,"attachments","layout","tabbable","template","click","focus"],["attachments",""],[3,"actions","tabbable","dispatch","click","focus"],["actions",""]],template:function(t,e){1&t&&(j.Lc(0,It,6,5,"ng-container",0),j.ac(1,"kendo-resize-sensor",1),j.jc("resize",(function(){return e.onResize()})),j.Zb()),2&t&&j.sc("ngForOf",e.view)("ngForTrackBy",e.trackGroup)},directives:function(){return[c.k,R.g,c.n,c.o,c.l,Nt,zt,$t,Ht]},encapsulation:2}),t}(),Bt=function(){function t(t,e,n){this.element=t,this.zone=e,this.renderer=n,this.autoScroll=!0,this.autoScrollChange=new j.o,this.overflowAnchor="none",this.scrolling=!1}return t.prototype.ngOnInit=function(){var t=this;this.zone.runOutsideAngular((function(){t.unsubscribe=t.renderer.listen(t.element.nativeElement,"scroll",(function(){return t.onScroll()}))}))},t.prototype.ngAfterViewInit=function(){this.scrollToBottom()},t.prototype.ngOnDestroy=function(){this.unsubscribe&&this.unsubscribe()},t.prototype.onScroll=function(){var t=this;if(!this.scrolling){var e=this.element.nativeElement,n=e.scrollHeight-(e.scrollTop+e.offsetHeight)<2;this.autoScroll!==n&&this.zone.run((function(){t.autoScroll=n,t.autoScrollChange.emit(t.autoScroll)}))}},t.prototype.scrollToBottom=function(){var t=this;if(this.autoScroll){var e=this.element.nativeElement;e.scrollTop=e.scrollHeight-e.clientHeight,this.scrolling=!0,this.zone.runOutsideAngular((function(){return setTimeout((function(){return t.scrolling=!1}),1e3)}))}},t.\u0275fac=function(e){return new(e||t)(j.Ub(j.m),j.Ub(j.C),j.Ub(j.H))},t.\u0275dir=j.Pb({type:t,selectors:[["","kendoChatScrollAnchor",""]],hostVars:2,hostBindings:function(t,e){2&t&&j.Kc("overflow-anchor",e.overflowAnchor)},inputs:{autoScroll:"autoScroll"},outputs:{autoScrollChange:"autoScrollChange"},exportAs:["scrollAnchor"]}),t}(),Ht=function(t){function e(){var e,n=null!==t&&t.apply(this,arguments)||this;return n.dispatch=new j.o,n.defaultClass=!0,n.selectedIndex=0,n.keyHandlers=((e={})[37]=function(t){return n.navigateTo(t,-1)},e[39]=function(t){return n.navigateTo(t,1)},e[13]=function(t,e){return n.actionClick(e)},e),n}return Object(I.d)(e,t),e.prototype.isSelected=function(t){return this.selected&&this.selectedIndex===t},e.prototype.actionClick=function(t){this.dispatch.next(t)},e.prototype.actionKeydown=function(t,e){var n=this.keyHandlers[t.keyCode];n&&n(t,e)},e.prototype.focus=function(){this.select(this.selectedIndex)},e.prototype.select=function(t){this.selectedIndex=t;var e=this.items.toArray()[t];e&&e.nativeElement.focus()},e.prototype.navigateTo=function(t,e){var n=this.selectedIndex,c=Math.max(0,Math.min(n+e,this.items.length-1));c!==n&&(this.select(c),t.preventDefault())},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=j.Ob({type:e,selectors:[["kendo-chat-suggested-actions"]],viewQuery:function(t,e){var n;1&t&&j.Rc(ct,!0),2&t&&j.Bc(n=j.kc())&&(e.items=n)},hostVars:2,hostBindings:function(t,e){2&t&&j.Mb("k-quick-replies",e.defaultClass)},inputs:{actions:"actions",tabbable:"tabbable"},outputs:{dispatch:"dispatch"},features:[j.Hb([{provide:Ft,useExisting:Object(j.Z)((function(){return e}))}]),j.Fb],decls:1,vars:1,consts:[["class","k-quick-reply",3,"k-state-selected","k-state-focused","k-first","k-last","click","keydown",4,"ngFor","ngForOf"],[1,"k-quick-reply",3,"click","keydown"],["item",""]],template:function(t,e){1&t&&j.Lc(0,Pt,3,10,"span",0),2&t&&j.sc("ngForOf",e.actions)},directives:[c.k],encapsulation:2}),e}(Ft),Kt=function(){function t(){}return t.\u0275mod=j.Sb({type:t}),t.\u0275inj=j.Rb({factory:function(e){return new(e||t)},imports:[[D.c,c.c,R.h]]}),t}(),qt=n("oLTx"),Yt=function(t,e){return{left:t,right:e,"message-container":!0}},Jt=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=j.Ob({type:t,selectors:[["zlife-message"]],inputs:{message:"message"},decls:7,vars:6,consts:[[3,"ngClass"],[1,"message"]],template:function(t,e){1&t&&(j.ac(0,"div",0),j.ac(1,"div",1),j.ac(2,"div"),j.Nc(3),j.Zb(),j.Nc(4,": "),j.ac(5,"h2"),j.Nc(6),j.Zb(),j.Zb(),j.Zb()),2&t&&(j.sc("ngClass",j.wc(3,Yt,0==e.message.side,1==e.message.side)),j.Ib(3),j.Oc(e.message.creationTime),j.Ib(3),j.Oc(e.message.message))},directives:[c.j],styles:[".left[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{background-color:green}.right[_ngcontent-%COMP%]{justify-content:flex-end}.right[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{background-color:red}.message-container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row}"]}),t}();function Qt(t,e){if(1&t&&(j.ac(0,"div"),j.ac(1,"p"),j.Nc(2),j.Zb(),j.Zb()),2&t){var n=e.$implicit;j.Ib(2),j.Oc(n.text)}}function Wt(t,e){1&t&&j.Vb(0,"zlife-message",6),2&t&&j.sc("message",e.$implicit)}var Xt=[{path:"",component:$},{path:"chat/:remoteUserId",component:function(t){function e(e,n,c,a){var s=t.call(this,"scrolls",a)||this;return s.router=e,s.store=n,s.messaggiService=c,s.scrollElement=null,s.remoteUserId=s.router.snapshot.params.remoteUserId,s.store.select((function(t){return t.remoteSession})).pipe(Object(N.a)()).subscribe((function(t){t.isInitiator&&s.store.dispatch(b({userId:t.userId,dispatchToRemote:!1}))})),s.messaggi$=c.receiveMessages(),s.zlifeMessages$=s.store.select(l),s}return Object(I.d)(e,t),e.prototype.sendMessage=function(t){this.store.dispatch(k({remoteUserId:this.remoteUserId,message:t.message.text,dispatchToRemote:!0}))},e.prototype.ngAfterViewInit=function(){var t=this;this.scrollElement=this.kendoChat.nativeElement.querySelector(".k-message-list"),this.inputElement=this.kendoChat.nativeElement.querySelector("input"),this.inputElement.addEventListener("keyup",(function(e){t.store.dispatch(O({message:e.target.value,dispatchToRemote:!0}))})),this.store.select(m).subscribe((function(e){t.inputElement.value=e}))},e.prototype.ngOnInit=function(){t.prototype.ngOnInit.call(this)},e.\u0275fac=function(t){return new(t||e)(j.Ub(a.a),j.Ub(i.h),j.Ub(T),j.Ub(s.f))},e.\u0275cmp=j.Ob({type:e,selectors:[["app-chat-page"]],viewQuery:function(t,e){var n;1&t&&j.Rc(Mt,!0,j.m),2&t&&j.Bc(n=j.kc())&&(e.kendoChat=n.first)},features:[j.Hb([{provide:s.f,useFactory:s.f.create([s.k,"chatPage"])}]),j.Fb],decls:12,vars:9,consts:[["padding",""],["zlifeNgrxScroll","",1,"chat-page__kendo-chat",3,"optNativeEl","elementId","user","messages","sendMessage"],["kendoChatMessageTemplate",""],["send","Invia","messagePlaceholder","Scrivi un nuovo messaggio"],["scrollName","chatPageScroll",1,"chat-page__list-scroller",3,"elements"],[3,"message",4,"zlifeListItem"],[3,"message"]],template:function(t,e){1&t&&(j.ac(0,"ion-header"),j.Vb(1,"zlife-status-bar"),j.Zb(),j.ac(2,"ion-content",0),j.ac(3,"kendo-chat",1),j.jc("sendMessage",(function(t){return e.sendMessage(t)})),j.nc(4,"async"),j.Lc(5,Qt,3,1,"ng-template",2),j.Vb(6,"kendo-chat-messages",3),j.Zb(),j.ac(7,"zlife-list-scroller-tracker",4),j.nc(8,"async"),j.Lc(9,Wt,1,1,"zlife-message",5),j.Zb(),j.Zb(),j.ac(10,"ion-footer"),j.Vb(11,"ion-toolbar"),j.Zb()),2&t&&(j.Ib(3),j.sc("optNativeEl",e.scrollElement)("elementId","chatScroll")("user",e.messaggiService.myUser)("messages",j.oc(4,5,e.messaggi$)),j.Ib(4),j.sc("elements",j.oc(8,7,e.zlifeMessages$)))},directives:[M.k,z.a,M.g,Mt,qt.a,Tt,Lt,Z.a,L.a,M.j,M.q,Jt],pipes:[c.b],styles:[".chat-page__kendo-chat[_ngcontent-%COMP%]{float:left;width:50%;height:100%}.chat-page__list-scroller[_ngcontent-%COMP%]{float:right;width:50%;height:100%}"]}),e}(s.e)}],Gt=function(){function t(){}return t.\u0275mod=j.Sb({type:t}),t.\u0275inj=j.Rb({factory:function(e){return new(e||t)},imports:[[a.l.forChild(Xt)],a.l]}),t}(),te=n("w1ql"),ee=Object(i.p)({contattiPage:{contatti:[],currentPage:1},chatPage:{currentChat:{messages:[],remoteUser:null,typing:""}}},Object(i.r)(g,(function(t,e){return Object(I.a)(Object(I.a)({},t),{contattiPage:Object(I.a)(Object(I.a)({},t.contattiPage),{contatti:e.contatti})})})),Object(i.r)(p,(function(t,e){return Object(I.a)(Object(I.a)({},t),{chatPage:Object(I.a)(Object(I.a)({},t.chatPage),{currentChat:Object(I.a)(Object(I.a)({},t.chatPage.currentChat),{messages:e.messages})})})})),Object(i.r)(d,(function(t,e){return Object(I.a)(Object(I.a)({},t),{chatPage:Object(I.a)(Object(I.a)({},t.chatPage),{currentChat:Object(I.a)(Object(I.a)({},t.chatPage.currentChat),{messages:Object(I.h)(t.chatPage.currentChat.messages,[e.message]),typing:e.clearTyping?"":t.chatPage.currentChat.typing})})})})),Object(i.r)(v,(function(t,e){return Object(I.a)(Object(I.a)({},t),{contattiPage:Object(I.a)(Object(I.a)({},t.contattiPage),{currentPage:e.currentPage})})})),Object(i.r)(y,(function(t,e){return Object(I.a)(Object(I.a)({},t),{chatPage:Object(I.a)(Object(I.a)({},t.chatPage),{currentChat:Object(I.a)(Object(I.a)({},t.chatPage.currentChat),{remoteUser:e.user})})})})),Object(i.r)(O,(function(t,e){return Object(I.a)(Object(I.a)({},t),{chatPage:Object(I.a)(Object(I.a)({},t.chatPage),{currentChat:Object(I.a)(Object(I.a)({},t.chatPage.currentChat),{typing:e.message})})})})));function ne(t,e){return ee(t,e)}var ce=n("15JJ"),ae=n("VnD/"),se=function(){function t(t,e,n){var c=this;this.actions$=t,this.messaggiService=e,this.store=n,this.contattiReceived$=Object(te.c)((function(){return c.actions$.pipe(Object(te.d)(h),Object(ce.a)((function(t){return c.messaggiService.getContattiList()})),Object(C.a)((function(t){return g({contatti:t,dispatchToRemote:!0})})))})),this.messaggiReceived$=Object(te.c)((function(){return c.actions$.pipe(Object(te.d)(b),Object(ce.a)((function(t){return c.messaggiService.getMessaggiList(t.userId)})),Object(C.a)((function(t){return p({messages:t,dispatchToRemote:!0})})))})),this.sendMessage$=Object(te.c)((function(){return c.actions$.pipe(Object(te.d)(k),Object(x.a)(c.store.select((function(t){return t.remoteSession.isInitiator}))),Object(ae.a)((function(t){return Object(I.g)(t,2)[1]})),Object(ce.a)((function(t){var e=Object(I.g)(t,1)[0];return c.messaggiService.sendMessage(e.remoteUserId,e.message)})),Object(C.a)((function(t){return d({dispatchToRemote:!0,message:{creationTime:new Date,id:1e3*Math.random(),message:t,side:1},clearTyping:!0})})))}))}return t.\u0275fac=function(e){return new(e||t)(j.fc(te.a),j.fc(T),j.fc(i.h))},t.\u0275prov=j.Qb({token:t,factory:t.\u0275fac}),t}(),ie=n("PCNd"),oe=function(){function t(){}return t.\u0275mod=j.Sb({type:t}),t.\u0275inj=j.Rb({factory:function(e){return new(e||t)},providers:[],imports:[[c.c,M.r,s.b,ie.a,Gt,i.j.forFeature(s.k,ne),te.b.forFeature([se]),Kt]]}),t}()}}]);